---
title: 数据库三范式
date: 2018-08-24 08:51:55
tags: 数据库
categories: 数据库
---

# 什么是三范式

<b style="font-size:16px">设计关系型数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式，各种范式呈递次规范，越高的范式数据库冗余越小。目前关系型数据库有六种范式：第一范式（1NF）、第二范式（2NF）、第三范式（3NF）、巴斯-科德范式（BCNF）、第四范式（4NF）和第五范式（5NF，又称完美范式）。一般来说，数据库只需要满足第三范式就行了。</b>

# 第一范式：保证每列的原子性
<b style="font-size:16px">第一范式是最基本的范式。如果数据库表中的所有字段值都是不可分解的原子值，就说明该数据库满足了第一范式。</b>
<b style="font-size:16px">第一范式需要根据系统的实际需求来定，比如有一张用户信息表：</b>
![图1-1](/image/database/1-1.png)
<b style="font-size:16px">一般来说"住址"设计成一个字段就行，但是如果经常访问"住址"中城市的部分，那么就非要将"住址"这个属性重新拆分为"省份"、"城市"、"地址"等多个部分进行存储，这样在对"住址"中某一部分进行操作的时候将非常方便。这么设计才算满足了数据库的第一范式，修改之后的表结构如图：</b>
![图1-2](/image/database/1-2.png)

# 第二范式：保证一张表只描述一件事情

<b style="font-size:16px">这是通俗的说法，用第二范式的定义描述第二范式，说的是在满足第一范式的基础上，数据库表中不存在非关键字段对任一候选关键字段的部分函数依赖，也即所有非关键字段都完全依赖于任一组候选关键字。</b>
<b style="font-size:16px">看不懂是吗，没关系，我也看不懂，下面举一个例子，有一张表如下图：</b>
![图1-3](/image/database/1-3.png)
<b style="font-size:16px">上表满足第一范式，即每个字段不可再分，但是这张表设计得并不好，或者说，这张表的设计并不满足第二范式。因为这张表里面描述了两件事情：学生信息、课程信息，"学分"完全依赖于"课程名称"、"姓名"与"年龄"完全依赖于"学号"。这么做的后果是：</b>
<li style="font-size:16px">数据冗余：同一门课程由n个学生选修，"学分"重复n-1次；同一个学生选修了m门课程，姓名和年龄重复m-1次</li>
<li style="font-size:16px">更新异常：若调整了某门课程的学分，数据表中所有行的"学分"值都需要更新，否则会出现同一门课程学分不同的情况</li>
<li style="font-size:16px">插入异常：假设要开一门新课程，暂时没有人选修，那么由于没有"学号"关键字，"课程"与"学分"也无法记录入数据库</li>
<li style="font-size:16px">删除异常：假设一批学生已经完成课程的选修，这些选修记录就应该从数据库表中删除。但是，与此同时，"课程"和"学分"也被删除了，显然，这最终可能会导致插入异常</li>
<b style="font-size:16px">所以，此表的结构必须修改，修改后如下：</b>

![](/image/database/1-4.png)<br>
![](/image/database/1-5.png)!<br>
![图1-4](/image/database/1-6.png)
<b style="font-size:16px">增加了表，将学生信息与课程信息通过一张中间表关联，很好地解决了上面的几个问题，这就是第二范式的中心----保证一张表只讲一件事情。</b>

# 第三范式----保证每列都和主键直接相关

<b style="font-size:16px">第三范式又和第二范式相关，用第三范式的定义描述第三范式就是，数据库表中如果不存在非关键字段任一候选关键字段的传递函数依赖则符合第三范式，所谓传递函数依赖指的是如果存在"A-->B-->C"的决定关系，则C传递函数依赖于A。也就是说表中的字段和主键直接对应不依靠其他中间字段，说白了就是，决定某字段值的必须是主键</b>
<b style="font-size:16px">举个例子，看一下如下的表结构：</b>
![图1-5](/image/database/1-7.png)

<b style="font-size:16px">第三范式和第二范式有点像，从这张数据库表结构中可以看出，"姓名"、"年龄"、"学院"和主键"学号"直接关联，但是"学院地点"、"学院电话"却不直接和主键"学号"相关联，和"学院电话"直接相关联的是"学院"，如果表结构这么设计，同样会造成和第二范式一样的数据冗余、更新异常、插入异常、删除异常的问题。</b>
<b style="font-size:16px">修改之后的表结构如下图：</b>
![图1-7](/image/database/1-9.png)
![图1-6](/image/database/1-8.png)
<b style="font-size:16px">同样，这么设计表结构将合理地多，也解决了前面的四个问题</b>


